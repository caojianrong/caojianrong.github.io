<html>
<head>
  <title>react组件通信</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600986 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="798"/>
<h1>react组件通信</h1>

<div>
<span><div><div><font style="font-size: 16pt; color: rgb(255, 0, 0);"><b>一、父子通信</b></font></div><div><font style="font-size: 14pt;"><b>1、父组件控制子组件元素的渲染：</b></font></div><ul><li><div><font style="font-size: 12pt;">将控制div显示的值（state）放到子组件上；</font></div></li><li><div><font style="font-size: 12pt;">子组件有一个修改state值得方法；</font></div></li><li><div><font style="font-size: 12pt;">通过ref，在父组件调用子组件的方法。</font></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">let Son = React.createClass({</font></div><div><font style="font-size: 12pt;">    getInitialState(){</font></div><div><font style="font-size: 12pt;">        return{</font></div><div><font style="font-size: 12pt;">            show:true</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">  <font color="#FF0000">  toggle</font>(num1,num2){</font></div><div><font style="font-size: 12pt;">        console.log(num1,num2)</font></div><div><font style="font-size: 12pt;">        this.setState({show:!this.state.show})</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    render(){</font></div><div><font style="font-size: 12pt;">        return(</font></div><div><font style="font-size: 12pt;">            &lt;div&gt;</font></div><div><font><span style="font-size: 12pt;">                &lt;h4&gt;</span><b><font style="font-size: 16pt;">子组件</font></b><span style="font-size: 12pt;">&lt;/h4&gt;</span></font></div><div><font style="font-size: 12pt;">                {!this.state.show || &lt;div className=&quot;pink&quot;&gt;&lt;/div&gt;}</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        )</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">let Component = React.createClass({</font></div><div><font style="font-size: 12pt;">    render(){</font></div><div><font style="font-size: 12pt;">        return(</font></div><div><font style="font-size: 12pt;">            &lt;div&gt;</font></div><div><font><span style="font-size: 12pt;">                &lt;h1&gt;</span><b><font style="font-size: 16pt;">父组件</font></b><span style="font-size: 12pt;">&lt;/h1&gt;</span></font></div><div><font style="font-size: 12pt;">               <font color="#FF0000"> &lt;button onClick={()=&gt;{</font></font></div><div><font color="#FF0000" style="font-size: 12pt;">                    this.refs.son.toggle(1,2)</font></div><div><font color="#FF0000" style="font-size: 12pt;">                }}&gt;toggle&lt;/button&gt;</font></div><div><font style="font-size: 12pt;">                &lt;hr/&gt;</font></div><div><font style="font-size: 12pt;">              <font color="#FF0000">  &lt;Son ref=&quot;son&quot;&gt;&lt;/Son&gt;</font></font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        )</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">ReactDOM.render(&lt;Component/&gt;,document.getElementById('app'))</font></div><div><br/></div></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;">2、父组件控制子组件元素的渲染：</span></div><ul><li><div><font style="font-size: 12pt;">控制元素渲染的数据放在父组件上；</font></div></li><li><div><font style="font-size: 12pt;">修改数据的方法放在父组件上；</font></div></li><li><div><font style="font-size: 12pt;">通过props将数据传递给子组件；</font></div></li><li><div><font style="font-size: 12pt;">父组件调用自己的方法修改。</font></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">let Son = React.createClass({</font></div><div><font style="font-size: 12pt;">    render(){</font></div><div><font style="font-size: 12pt;">        return(</font></div><div><font style="font-size: 12pt;">            &lt;div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h4&gt;子组件&lt;/h4&gt;</font></div><div><font style="font-size: 12pt;">                {!<font color="#FF0000">this.props.toggle</font> || &lt;div className=&quot;pink&quot;&gt;&lt;/div&gt;}</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        )</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">let Component = React.createClass({</font></div><div><font style="font-size: 12pt;">    getInitialState(){</font></div><div><font style="font-size: 12pt;">        return{</font></div><div><font style="font-size: 12pt;">            show:true</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    render(){</font></div><div><font style="font-size: 12pt;">        return(</font></div><div><font style="font-size: 12pt;">            &lt;div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h1&gt;父组件&lt;/h1&gt;</font></div><div><font style="font-size: 12pt;">               <font color="#FF0000"> &lt;button onClick={()=&gt;{</font></font></div><div><font color="#FF0000" style="font-size: 12pt;">                    this.setState({show:!this.state.show})</font></div><div><font color="#FF0000" style="font-size: 12pt;">                }}&gt;toggle&lt;/button&gt;</font></div><div><font style="font-size: 12pt;">                &lt;hr/&gt;</font></div><div><font style="font-size: 12pt;">                &lt;Son <font color="#FF0000">toggle={this.state.show}</font>&gt;&lt;/Son&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        )</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">})</font></div><div><br/></div><div><br/></div><div><font style="font-size: 12pt;">ReactDOM.render(&lt;Component/&gt;,document.getElementById('app'))</font></div><div><br/></div></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-weight: bold;">二、子父通信</span></div><div><span style="font-size: 18.6667px;"><b>子组件控制父组件</b></span></div><ul><li><div><font style="font-size: 12pt;">数据在父组件上；</font></div></li><li><div><font style="font-size: 12pt;">修改数据的方法在父组件上；</font></div></li><li><div><font style="font-size: 12pt;">将父组件的方法传给子组件调用</font></div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">let Son = React.createClass({</font></div><div><font style="font-size: 12pt;">    render(){</font></div><div><font style="font-size: 12pt;">        console.log(this)</font></div><div><font style="font-size: 12pt;">        return(</font></div><div><font style="font-size: 12pt;">            &lt;div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h4&gt;子组件&lt;/h4&gt;</font></div><div><font style="font-size: 12pt;">                &lt;button onClick={()=&gt;{</font></div><div><font style="font-size: 12pt;">                 <font color="#FF0000">   this.props.sonToggle(1,2)</font></font></div><div><font style="font-size: 12pt;">                }}&gt;toggle&lt;/button&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        )</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">let Component = React.createClass({</font></div><div><font style="font-size: 12pt;">    getInitialState(){</font></div><div><font style="font-size: 12pt;">      return{</font></div><div><font style="font-size: 12pt;">          show:true</font></div><div><font style="font-size: 12pt;">      }  </font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    toggle(num1,num2){</font></div><div><font style="font-size: 12pt;">        console.log(num1,num2);</font></div><div><font style="font-size: 12pt;">        this.setState({show:!this.state.show})</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    render(){</font></div><div><font style="font-size: 12pt;">        return(</font></div><div><font style="font-size: 12pt;">            &lt;div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h1&gt;父组件&lt;/h1&gt;</font></div><div><font style="font-size: 12pt;">                {!this.state.show || &lt;div className=&quot;pink&quot;&gt;&lt;/div&gt;}</font></div><div><font style="font-size: 12pt;">                &lt;hr/&gt;</font></div><div><font style="font-size: 12pt;">                &lt;Son <font color="#FF0000">sonToggle={this.toggle}</font>&gt;&lt;/Son&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        )</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">ReactDOM.render(&lt;Component/&gt;,document.getElementById('app'))</font></div><div><br/></div></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-weight: bold;">三、兄弟通信</span></div><div><span style="font-size: 18.6667px;"><b>亲兄弟通信：</b></span></div><ul><li><div><font style="font-size: 12pt;">子元素控制另一个子元素的div显示；</font></div></li><li><div><font style="font-size: 12pt;">控制变量的值放在公有的父组件上；</font></div></li><li><div><font style="font-size: 12pt;">控制变量的方法也在公有的父组件上；</font></div></li><li><div><font style="font-size: 12pt;">结合父组件和子父通信。</font></div></li></ul><div><span style="font-size: 12pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 12pt;">let Son1 = React.createClass({</font></div><div><font style="font-size: 12pt;">    render(){</font></div><div><font style="font-size: 12pt;">        return(</font></div><div><font style="font-size: 12pt;">            &lt;div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h4&gt;子组件1&lt;/h4&gt;</font></div><div><font style="font-size: 12pt;">           <font color="#FF0000">    {!this.props.show  || &lt;div className=&quot;pink&quot;&gt;&lt;/div&gt;}</font></font></div><div><font style="font-size: 12pt;">                &lt;hr/&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        )</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">let Son2 = React.createClass({</font></div><div><font style="font-size: 12pt;">    render(){</font></div><div><font style="font-size: 12pt;">        return(</font></div><div><font style="font-size: 12pt;">            &lt;div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h4&gt;子组件2&lt;/h4&gt;</font></div><div><font style="font-size: 12pt;">                &lt;button onClick={()=&gt;{</font></div><div><font style="font-size: 12pt;">                    <font color="#FF0000">this.props.toggle()</font></font></div><div><font style="font-size: 12pt;">                }}&gt;toggle&lt;/button&gt;</font></div><div><font style="font-size: 12pt;">                </font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        )</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">let Component = React.createClass({</font></div><div><font style="font-size: 12pt;">    getInitialState(){</font></div><div><font style="font-size: 12pt;">        return{</font></div><div><font style="font-size: 12pt;">            show:true</font></div><div><font style="font-size: 12pt;">        }</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    toggle(){</font></div><div><font style="font-size: 12pt;">        this.setState({show:!this.state.show})</font></div><div><font style="font-size: 12pt;">    },</font></div><div><font style="font-size: 12pt;">    render(){</font></div><div><font style="font-size: 12pt;">        return(</font></div><div><font style="font-size: 12pt;">            &lt;div&gt;</font></div><div><font style="font-size: 12pt;">                &lt;h1&gt;父组件&lt;/h1&gt;</font></div><div><font style="font-size: 12pt;">                &lt;hr/&gt;</font></div><div><font style="font-size: 12pt;">               <font color="#FF0000"> &lt;Son1 show={this.state.show}&gt;&lt;/Son1&gt;</font></font></div><div><font color="#FF0000" style="font-size: 12pt;">                &lt;Son2 toggle={this.toggle}&gt;&lt;/Son2&gt;</font></div><div><font style="font-size: 12pt;">            &lt;/div&gt;</font></div><div><font style="font-size: 12pt;">        )</font></div><div><font style="font-size: 12pt;">    }</font></div><div><font style="font-size: 12pt;">})</font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;"><br/></font></div><div><font style="font-size: 12pt;">ReactDOM.render(&lt;Component/&gt;,document.getElementById('app'))</font></div><div><br/></div></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div><div><span style="font-size: 14pt; font-weight: bold;"><br/></span></div></div></span>
</div></body></html> 